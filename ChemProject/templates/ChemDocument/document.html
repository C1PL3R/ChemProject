{% extends "template.html" %}
{% load static %}

{% block title %}
{{ title }} |
{% if document_id and document %}
{% if document.is_private %}üîê{% else %}üîì{% endif %} {{ document.title }} 
{% else %}
–ú–æ—ó –¥–æ–∫—É–º–µ–Ω—Ç–∏
{% endif %}
{% endblock %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/desktop/document.css' %}">
<link rel="stylesheet" href="{% static 'css/desktop/input.css' %}">
{% endblock %}

{% block body %}
<h1 id="DocumentId" style="display: none;">{{ document_id }}</h1>

{% if document_is_private %}
<div class="private-doc-container">
    <h1 class="private-doc">–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–∏–≤–∞—Ç–Ω–∏–π, –≤–∞–º –Ω–µ –Ω–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∞ –π–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏!</h1>
</div>
{% else %}

{% if document_id %}
<span id="title" style="display: none;">{{ title }} | {{ document.title }}</span>
<div class="doc_area">
    <div class="edit_text_container">
        <button id="boldBtn" onclick="formatText('bold')">
            <svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'>
                <g id="bold_fill" fill='none'>
                    <path
                        d='M24 0v24H0V0zM12.593 23.258l-.011.002-.071.035-.02.004-.014-.004-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z' />
                    <path fill='#09244BFF'
                        d='M13 2.5a5.5 5.5 0 0 1 4.213 9.036 5.5 5.5 0 0 1-2.992 9.96L14 21.5H6.1a1.6 1.6 0 0 1-1.593-1.454L4.5 19.9V4.1a1.6 1.6 0 0 1 1.454-1.593L6.1 2.5zm1 11H7.5v5H14a2.5 2.5 0 0 0 0-5m-1-8H7.5v5H13a2.5 2.5 0 0 0 0-5' />
                </g>
            </svg>
        </button>
        <button onclick="formatText('italic')" id="italicBtn">
            <svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'>
                <g id="italic_fill" fill='none'>
                    <path
                        d='M24 0v24H0V0zM12.593 23.258l-.011.002-.071.035-.02.004-.014-.004-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z' />
                    <path fill='#09244BFF'
                        d='M16 2.5h-6a1.5 1.5 0 0 0 0 3h1.3l-1.624 13H8a1.5 1.5 0 0 0 0 3h6a1.5 1.5 0 0 0 0-3h-1.3l1.624-13H16a1.5 1.5 0 0 0 0-3' />
                </g>
            </svg>
        </button>
        <button onclick="formatText('underline')">
            <svg xmlns='http://www.w3.org/2000/svg' width='32px' height='32px' viewBox='0 0 24 24'>
                <g id="underline_fill" fill='none'>
                    <path
                        d='M24 0v24H0V0zM12.593 23.258l-.011.002-.071.035-.02.004-.014-.004-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z' />
                    <path fill='#09244BFF'
                        d='M18 18.5a1.5 1.5 0 0 1 .144 2.993L18 21.5H6a1.5 1.5 0 0 1-.144-2.993L6 18.5zm-1-16a1.5 1.5 0 0 1 1.493 1.356L18.5 4v7a6.5 6.5 0 0 1-12.996.233L5.5 11V4a1.5 1.5 0 0 1 2.993-.144L8.5 4v7a3.5 3.5 0 0 0 6.995.192L15.5 11V4A1.5 1.5 0 0 1 17 2.5' />
                </g>
            </svg>
        </button>
    </div>
    <div id="docEditor" contenteditable="true">{{ document.text|safe }}</div>
</div>

{% else %}
<span id="title" style="display: none;">{{ title }} | –ú–æ—ó –¥–æ–∫—É–º–µ–Ω—Ç–∏</span>

<div id="create-doc">
    <div class="flex-wrapper">
        <div class="elements">
            <div class="close-container">
                <span>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞</span>
                <button id="close">
                    <svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'>
                        <title>–ó–∞–∫—Ä–∏—Ç–∏</title>
                        <g id="close_square_fill" fill='none' fill-rule='evenodd'>
                            <path
                                d='M24 0v24H0V0zM12.594 23.258l-.012.002-.071.035-.02.004-.014-.004-.071-.036c-.01-.003-.019 0-.024.006l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.016-.018m.264-.113-.014.002-.184.093-.01.01-.003.011.018.43.005.012.008.008.201.092c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.003-.011.018-.43-.003-.012-.01-.01z' />
                            <path fill='#FFFFFFFF'
                                d='M3 5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2zm5.464 3.465a1 1 0 0 1 1.415 0l2.12 2.12 2.122-2.12a1 1 0 1 1 1.415 1.414L13.414 12l2.122 2.121a1 1 0 1 1-1.415 1.415L12 13.414l-2.121 2.122a1 1 0 0 1-1.415-1.415L10.586 12 8.464 9.879a1 1 0 0 1 0-1.414' />
                        </g>
                    </svg>
                </button>
            </div>

            <div class="elements-container">
                <div class="icon-container">
                    <span>–û–±–µ—Ä—ñ—Ç—å —ñ–∫–æ–Ω–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–∞</span>
                    <div class="icon-buttons-container">
                        <div class="buttons">
                            {% for icon in icons_list_1 %}
                            <button title="–ù–∞—Ç–∏—Å–Ω—É–≤—à–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –≤–∏–±—ñ—Ä —ñ–∫–æ–Ω–∫–∏"
                                onclick="ChooseIcon('{{ icon }}', this)">
                                <img src="{% static 'images/' %}{{ icon }}.svg" alt="?">
                            </button>
                            {% endfor %}
                        </div>
                        <div class="buttons">
                            {% for icon in icons_list_2 %}
                            <button title="–ù–∞—Ç–∏—Å–Ω—É–≤—à–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –≤–∏–±—ñ—Ä —ñ–∫–æ–Ω–∫–∏"
                                onclick="ChooseIcon('{{ icon }}', this)">
                                <img src="{% static 'images/' %}{{ icon }}.svg" alt="?">
                            </button>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <input type="text" id="NewDocInputTitle" placeholder="–ù–∞–∑–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞" value="–î–æ–∫—É–º–µ–Ω—Ç –ë–µ–∑ –ù–∞–∑–≤–∏">
                <button onclick="CreateNewDoc()">–°—Ç–≤–æ—Ä–∏—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç!</button>
            </div>
        </div>
    </div>
</div>


{% if not docs %}
    <div class="no-docs-container">
        <p class="no-docs">–°—Ç–≤–æ—Ä—ñ—Ç—å —Å–≤—ñ–π –ø–µ—Ä—à–∏–π –¥–æ–∫—É–º–µ–Ω—Ç!</p>
    </div>
{% else %}
    <div class="docs">
        {% for doc in docs %}
        <div class="doc" oncontextmenu="OpenContextMenu(this, '{{ doc.id }}'); return false;">
            <div class="doc_icon">
                <img src="{% static 'images/' %}{{ doc.icon }}.svg" alt="">
            </div>
            <a href="{{ doc.id }}">{{ doc.title }}</a>
        </div>
        {% endfor %}
    </div>
{% endif %}

{% endif %}

<div id="customMenu">
    <div class="delete_doc" onclick="DeleteDocument();">
        <svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'>
            <g id="delete_fill" fill='none'>
                <path
                    d='M24 0v24H0V0zM12.593 23.258l-.011.002-.071.035-.02.004-.014-.004-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z' />
                <path fill='#FFFFFFFF'
                    d='M20 5a1 1 0 1 1 0 2h-1l-.003.071-.933 13.071A2 2 0 0 1 16.069 22H7.93a2 2 0 0 1-1.995-1.858l-.933-13.07A1.017 1.017 0 0 1 5 7H4a1 1 0 0 1 0-2zm-6-3a1 1 0 1 1 0 2h-4a1 1 0 0 1 0-2z' />
            </g>
        </svg>
        <span>–í–∏–¥–∞–ª–∏—Ç–∏</span>
    </div>

    <div class="private_doc">
        <svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'>
            <title>lock_fill</title>
            <g id="lock_fill" fill='none' fill-rule='evenodd'>
                <path
                    d='M24 0v24H0V0zM12.593 23.258l-.011.002-.071.035-.02.004-.014-.004-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z' />
                <path fill='#FFFFFFFF'
                    d='M6 8a6 6 0 1 1 12 0h1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2zm6-4a4 4 0 0 1 4 4H8a4 4 0 0 1 4-4m2 10a2 2 0 0 1-1 1.732V17a1 1 0 1 1-2 0v-1.268A2 2 0 0 1 12 12a2 2 0 0 1 2 2' />
            </g>
        </svg>

        <span>–ó—Ä–æ–±–∏—Ç–∏ –ø—Ä–∏–≤–∞—Ç–Ω–∏–º</span>
    </div>
</div>



<div id="DocSettings">
    <div class="settings-wrapper">
        <div class="elements">
            <div class="close-container">
                <span>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞</span>
                <button id="close" onclick="CloseSettings();">
                    <svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'>
                        <title>–ó–∞–∫—Ä–∏—Ç–∏</title>
                        <g id="close_square_fill" fill='none' fill-rule='evenodd'>
                            <path
                                d='M24 0v24H0V0zM12.594 23.258l-.012.002-.071.035-.02.004-.014-.004-.071-.036c-.01-.003-.019 0-.024.006l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.016-.018m.264-.113-.014.002-.184.093-.01.01-.003.011.018.43.005.012.008.008.201.092c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.003-.011.018-.43-.003-.012-.01-.01z' />
                            <path fill='#FFFFFFFF'
                                d='M3 5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2zm5.464 3.465a1 1 0 0 1 1.415 0l2.12 2.12 2.122-2.12a1 1 0 1 1 1.415 1.414L13.414 12l2.122 2.121a1 1 0 1 1-1.415 1.415L12 13.414l-2.121 2.122a1 1 0 0 1-1.415-1.415L10.586 12 8.464 9.879a1 1 0 0 1 0-1.414' />
                        </g>
                    </svg>
                </button>
            </div>

            <div class="elements-container">
                <div class="icons-for-document">
                    <span>–Ü–∫–æ–Ω–∫–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞</span>
                    <div class="icon-buttons-container">
                        <span id="currentDocIcon" style="display: none;">{{ document.icon }}</span>
                        <div class="buttons">
                            {% for icon in icons_list_1 %}
                            <button id="{{ icon }}" title="–ù–∞—Ç–∏—Å–Ω—É–≤—à–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –≤–∏–±—ñ—Ä —ñ–∫–æ–Ω–∫–∏"
                                onclick="ChooseIcon('{{ icon }}', this)">
                                <img src="{% static 'images/' %}{{ icon }}.svg" alt="?">
                            </button>
                            {% endfor %}
                        </div>
                        <div class="buttons">
                            {% for icon in icons_list_2 %}
                            <button id="{{ icon }}" title="–ù–∞—Ç–∏—Å–Ω—É–≤—à–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –≤–∏–±—ñ—Ä —ñ–∫–æ–Ω–∫–∏"
                                onclick="ChooseIcon('{{ icon }}', this)">
                                <img src="{% static 'images/' %}{{ icon }}.svg" alt="?">
                            </button>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div id="documentPrivacySettings">
                    <div class="checkbox-container">
                        {% if document.is_private %}
                        <input type="checkbox" name="is_private" id="isPrivate" checked>
                        {% else %}
                        <input type="checkbox" name="is_private" id="isPrivate">
                        {% endif %}
                        <label for="is_private">–ü—Ä–∏–≤–∞—Ç–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç</label>
                    </div>

                    <div id="allowedUsers">
                        <div class="add_allowed_user">
                            <span>–î–æ–¥–∞—Ç–∏ –¥–æ–∑–≤–æ–ª–µ–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</span>
                            <input type="email" placeholder="–ï–ª. –ø–æ—à—Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞" id="allowedUserEmail">
                            <button id="addAllowedUser">–î–æ–¥–∞—Ç–∏</button>
                        </div>
                        <span class="info-text">–î–æ–∑–≤–æ–ª–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ</span>
                        <div class="users">
                            {% for user in document.allowed_users.all %}
                            <span class="allowed_user">{{ user.username }}</span>
                            {% empty %}
                            <span style="color: var(--paragraph-text-color);">–ù–µ–º–∞—î –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</span>
                            {% endfor %}
                        </div>

                    </div>
                </div>

            </div>
            <div class="saveBtn">
                <button type="submit" onclick="SaveSettings()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </div>
    </div>
</div>

<script src="{% static 'js/document.js' %}"></script>
<script>
    function formatText(command) {
        document.execCommand(command, false, null);
    }
</script>

{% endif %}
{% endblock %}